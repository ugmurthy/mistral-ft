//
// TESTING : Call fibrese sense from localhost
//
import { useLoaderData,useFetcher } from "@remix-run/react";
export async function loader() {
    return {message:"Post Dummy data to fibreSense from S2"}
}


export default function Fibresense() {

    const fetcher = useFetcher();
function postit() {
    const formData = new FormData();
      
      formData.append("template","{default:'text'}");//check if template should be a string
      
      formData.append("product_reference_number","");
      formData.append("product_source","");
      formData.append("product_details","");
      formData.append("product_remarks","");
      formData.append("labelled_composition","");
      formData.append("fs_vector","")
      formData.append("fs_device","");
      formData.append("fs_collection_name","measurement");
      formData.append("fs_process","analyse")
      console.log("2. posting formdata")
      const response = 
    //   fetcher.submit( formData,{
    //     action:"https://jsfibresense-experiments.vercel.app/vdb/s2",
    //     method:"post"
    //   })
      console.log("3. after submit")
}

    const {message} = useLoaderData();
    const defaultTemplate = JSON.stringify({
    "product_reference_number": "text",
    "product_source": "text",
    "product_details": "json",
    "product_remarks": "text",
    "labelled_composition": "text"
                })
    // NIR has 701 dummy points
    const NIR = [
        0.037764322, 0.03779056, 0.03780818, 0.037819814, 0.037828088, 0.037835203,
        0.037841532, 0.037846956, 0.037851367, 0.03785459, 0.03785631, 0.03785619,
        0.037853923, 0.03785064, 0.037849866, 0.037855346, 0.03787057, 0.03789297,
        0.03791371, 0.037923645, 0.03791459, 0.03788938, 0.037858013, 0.037830617,
        0.037815787, 0.0378124, 0.037815493, 0.0378201, 0.03782242, 0.03782292,
        0.03782303, 0.037824176, 0.037826926, 0.037830014, 0.037831962, 0.03783128,
        0.03782649, 0.037817437, 0.037807483, 0.03780051, 0.03780037, 0.03780818,
        0.037820943, 0.037835345, 0.03784813, 0.037857097, 0.03786098, 0.03785855,
        0.037849035, 0.037835624, 0.037823472, 0.03781776, 0.037822127, 0.03783351,
        0.037847046, 0.037857868, 0.037863035, 0.037864037, 0.037862975, 0.03786194,
        0.037862334, 0.03786471, 0.03786957, 0.03787725, 0.037886094, 0.03789305,
        0.037895035, 0.037889704, 0.037879176, 0.037867237, 0.037857655, 0.037854217,
        0.037859824, 0.037871752, 0.037885062, 0.037894826, 0.037897717, 0.037895434,
        0.037890658, 0.037886042, 0.037883338, 0.03788287, 0.037884843, 0.037889387,
        0.03789555, 0.037901487, 0.03790532, 0.03790569, 0.037904587, 0.037905402,
        0.03791152, 0.037924573, 0.037940755, 0.03795522, 0.03796319, 0.037963416,
        0.037959944, 0.03795724, 0.037959475, 0.037966665, 0.03797573, 0.03798351,
        0.037987404, 0.037987936, 0.037986748, 0.037985478, 0.037985772, 0.03798884,
        0.037993733, 0.037998796, 0.03800238, 0.03800376, 0.038004287, 0.038005605,
        0.038009293, 0.038015466, 0.038022693, 0.03802946, 0.03803439, 0.03803725,
        0.038038358, 0.038038027, 0.03803674, 0.038035538, 0.03803557, 0.03803796,
        0.038042363, 0.03804631, 0.03804716, 0.03804264, 0.038034845, 0.038028777,
        0.038029492, 0.03804048, 0.03805819, 0.038077116, 0.038091775, 0.03809915,
        0.038100746, 0.038098548, 0.03809454, 0.03809069, 0.038088154, 0.038086895,
        0.03808678, 0.038087666, 0.038089223, 0.038091004, 0.038092565, 0.038093764,
        0.038095728, 0.038099878, 0.038107626, 0.038118474, 0.03812898, 0.038135424,
        0.038134497, 0.038127545, 0.038118977, 0.03811325, 0.03811351, 0.03811757,
        0.038121928, 0.038123097, 0.038119636, 0.038113207, 0.038105737, 0.03809909,
        0.038094312, 0.038091976, 0.038092636, 0.038096853, 0.038104795, 0.03811388,
        0.038120378, 0.038120527, 0.038112562, 0.038099445, 0.03808487, 0.038072325,
        0.038061984, 0.038050927, 0.03803612, 0.038015213, 0.03798969, 0.03796233,
        0.0379359, 0.037912507, 0.037892982, 0.03787801, 0.03786812, 0.03786167,
        0.037855495, 0.037846386, 0.03783206, 0.03781376, 0.03779358, 0.03777357,
        0.03775426, 0.037734143, 0.03771157, 0.03768514, 0.037655517, 0.037624322,
        0.037593197, 0.037563767, 0.037537124, 0.037511863, 0.03748591, 0.037457198,
        0.03742493, 0.03739015, 0.037354033, 0.03731766, 0.03728123, 0.03724451,
        0.037207253, 0.03716924, 0.037130322, 0.03709036, 0.0370492, 0.037006598,
        0.036962204, 0.036915686, 0.03686709, 0.036818136, 0.036770992, 0.036727797,
        0.036690086, 0.03665855, 0.03663384, 0.036616456, 0.03660579, 0.03660079,
        0.03660041, 0.036604207, 0.036613, 0.036627736, 0.036649376, 0.03667882,
        0.03671567, 0.036758162, 0.036804456, 0.036852904, 0.036902796, 0.036953714,
        0.03700524, 0.037056714, 0.0371071, 0.037155334, 0.03720058, 0.037243567,
        0.03728575, 0.037328575, 0.03737231, 0.037414923, 0.03745411, 0.037487835,
        0.037516955, 0.03754403, 0.037571646, 0.037601426, 0.037632555, 0.03766384,
        0.037694115, 0.03772282, 0.037749805, 0.037774943, 0.0377981, 0.03781915,
        0.037837967, 0.03785443, 0.037868448, 0.037881117, 0.03789523, 0.037913695,
        0.037938707, 0.037967835, 0.037996825, 0.038021475, 0.038039878, 0.038053844,
        0.038065493, 0.03807672, 0.038087726, 0.038097974, 0.038106937, 0.03811456,
        0.038121577, 0.038128823, 0.038136885, 0.03814448, 0.03814948, 0.03814976,
        0.038145296, 0.03813981, 0.038137406, 0.03814158, 0.03815114, 0.038162712,
        0.038172882, 0.03817826, 0.03817723, 0.03817312, 0.03817012, 0.03817216,
        0.03817975, 0.038190998, 0.03820396, 0.038216814, 0.038228087, 0.038236354,
        0.03824038, 0.0382411, 0.038240843, 0.038241968, 0.03824571, 0.038250774,
        0.038255475, 0.038258348, 0.03825977, 0.03826118, 0.038264003, 0.038268823,
        0.038274523, 0.038279787, 0.03828348, 0.03828578, 0.038287498, 0.038289435,
        0.038291756, 0.038293645, 0.038294185, 0.03829247, 0.03828785, 0.03828217,
        0.038278714, 0.038280737, 0.03828899, 0.038299575, 0.038308095, 0.038310908,
        0.038309522, 0.038307644, 0.038308915, 0.038314424, 0.03832173, 0.03832813,
        0.03833154, 0.038332712, 0.038333252, 0.038334683, 0.03833684, 0.038337894,
        0.038335953, 0.03833042, 0.038324784, 0.038323324, 0.038329866, 0.038342733,
        0.038356632, 0.038366184, 0.03836602, 0.03835369, 0.03833541, 0.038319036,
        0.038311757, 0.03831357, 0.038320035, 0.038326666, 0.038330495, 0.03833133,
        0.038329285, 0.038324583, 0.03831825, 0.038311593, 0.038305882, 0.038301524,
        0.038297955, 0.038294572, 0.038290642, 0.038285006, 0.03827641, 0.038263824,
        0.038248394, 0.03823268, 0.03821925, 0.03820906, 0.038200263, 0.03819073,
        0.038178664, 0.03816404, 0.03814743, 0.03812941, 0.038110536, 0.038090594,
        0.03806838, 0.038042612, 0.038012613, 0.03797992, 0.03794659, 0.0379145,
        0.037883192, 0.03785065, 0.037814837, 0.03777499, 0.037732538, 0.03768915,
        0.037646305, 0.037604555, 0.037564177, 0.037525393, 0.037487764, 0.03745028,
        0.03741192, 0.0373724, 0.03733299, 0.037295174, 0.03726016, 0.037227526,
        0.037196245, 0.037165344, 0.03713493, 0.037106153, 0.0370802, 0.03705826,
        0.037040938, 0.037026882, 0.037014347, 0.03700174, 0.036988884, 0.036976356,
        0.036964722, 0.036953706, 0.036941934, 0.03692796, 0.03691052, 0.036888916,
        0.036862563, 0.03683103, 0.036795232, 0.03675677, 0.036717203, 0.036676917,
        0.036634896, 0.036590055, 0.036542073, 0.036492858, 0.03644467, 0.036399286,
        0.036354907, 0.036308203, 0.03625596, 0.036197837, 0.036136284, 0.036073867,
        0.036013164, 0.03595612, 0.035902884, 0.035853293, 0.035807516, 0.03576822,
        0.03573911, 0.035723753, 0.035722252, 0.03573148, 0.035748195, 0.035770424,
        0.035798788, 0.03583421, 0.035876967, 0.03592441, 0.035973027, 0.03601968,
        0.036065277, 0.036113247, 0.03616699, 0.036227044, 0.036290266, 0.03635327,
        0.036413606, 0.036471352, 0.03652699, 0.036581017, 0.036633838, 0.036685143,
        0.036734305, 0.036780745, 0.036824986, 0.036868613, 0.036913227, 0.036959156,
        0.037004385, 0.03704664, 0.037084535, 0.03712003, 0.037155878, 0.037194263,
        0.037232697, 0.0372664, 0.037290815, 0.037305955, 0.037316073, 0.037325565,
        0.037336454, 0.037346624, 0.03735356, 0.03735569, 0.037354626, 0.037352663,
        0.03735187, 0.037352797, 0.037355386, 0.03735955, 0.03736523, 0.037372474,
        0.037381433, 0.03739227, 0.03740581, 0.037423983, 0.037448816, 0.03748084,
        0.037516065, 0.037549656, 0.037577685, 0.03760142, 0.037623968, 0.037648227,
        0.037674643, 0.037702147, 0.037729647, 0.037756473, 0.037782375, 0.03780713,
        0.03783023, 0.037850652, 0.037867315, 0.03788002, 0.03789133, 0.037904344,
        0.037921537, 0.03794188, 0.037963163, 0.037983157, 0.037999764, 0.038012344,
        0.038021263, 0.038026918, 0.03803054, 0.03803421, 0.038040053, 0.038048286,
        0.03805585, 0.03805935, 0.038057413, 0.03805427, 0.038055126, 0.03806377,
        0.038077526, 0.038091846, 0.03810269, 0.038109824, 0.03811476, 0.038118914,
        0.038122244, 0.0381237, 0.03812224, 0.038117845, 0.03811154, 0.038104426,
        0.038097583, 0.03809193, 0.038088076, 0.038086593, 0.03808746, 0.03808904,
        0.038089428, 0.038087398, 0.03808447, 0.038082846, 0.038084302, 0.038087994,
        0.0380921, 0.03809497, 0.038096685, 0.038098246, 0.038100604, 0.038103614,
        0.03810632, 0.03810774, 0.03810721, 0.038104367, 0.038098875, 0.038091313,
        0.038083512, 0.038077414, 0.038074613, 0.038076073, 0.038082678, 0.038095295,
        0.03811329, 0.03813155, 0.03814415, 0.038147125, 0.03814442, 0.03814196,
        0.038144566, 0.038151193, 0.038158808, 0.03816462, 0.03816769, 0.03816789,
        0.038165204, 0.03816061, 0.038155667, 0.038151857, 0.038149633, 0.03814871,
        0.0381488, 0.038149815, 0.03815181, 0.038154878, 0.03815874, 0.038162787,
        0.038166385, 0.038169175, 0.038171135, 0.03817227, 0.038172603, 0.03817219,
        0.038171228, 0.0381699, 0.03816932, 0.038172428, 0.03818237, 0.0381996,
        0.038218006, 0.03823054, 0.038232528, 0.038226016, 0.03821423, 0.03820019,
        0.038186226, 0.038174536, 0.038166564, 0.038160887, 0.038155418, 0.03814878,
        0.038142666, 0.0381396, 0.038141187, 0.038144615, 0.038145747, 0.038141243,
        0.038131997, 0.038120333, 0.038108557, 0.038098928, 0.038093273, 0.03809326,
        0.03809997, 0.03811051, 0.03812042, 0.038126003, 0.038129006, 0.03813347,
        0.038142532, 0.0381526, 0.038157105, 0.038150653, 0.038136944, 0.038123835,
        0.038118124, 0.03811825, 0.038118705, 0.03811471, 0.03810714, 0.03809955,
        0.038095146, 0.038094398, 0.038096465, 0.03810052, 0.038105458, 0.038108304,
        0.03810521, 0.038093075, 0.038074415, 0.03805423, 0.0380373, 0.0380266,
        0.038024366, 0.038032304, 0.03804868, 0.038070373, 0.038093887, 0.03811342,
        0.03812231, 0.038116757, 0.038108923, 0.038116507, 0.038153294
      ]

    // n401 has 401 points
    const n401 = NIR.slice(0, 401);

    // use NIR or n401 depending on what you are trying to simulate
    // ensure settings in fibreSense mataches with vector size
    // so start fibresense and save vector_size to required size 401 or 701
    const measurement = JSON.stringify(n401);
    const len = JSON.parse(measurement).length;

    console.log("1. ",message)
    return (
        <div>
          <h1>Fibresense</h1>
          <a href="https://jsfibresense-experiments.vercel.app/">
          <p>{message}</p>
          <p>vector_size: {len}</p>
          </a>

         <form method="POST" action="https://jsfibresense-experiments.vercel.app/vdb/s2">
            <input type="text" name="template" value={defaultTemplate} hidden readOnly/>
            <input type="text" name="product_reference_number" value="Test Reference" hidden readOnly/>
            <input type="text" name="product_source" value="Test Source" hidden readOnly />
            <input type="text" name="product_details" value="Test Details" hidden readOnly/>
            <input type="text" name="product_remarks" value="Test Remarks" hidden readOnly/>
            <input type="text" name="labelled_composition" value="Test composition" hidden readOnly/>
            <input type="text" name="fs_vector" value={measurement} hidden readOnly />
            <input type="text" name="fs_device" value="" hidden readOnly/>
            <input type="text" name="fs_collection_name" value="measurement" hidden readOnly/>
            <input type="text" name="fs_process" value="analyse" hidden readOnly />
            <input type="text" name="fs_device" value="" hidden readOnly />
            <button className="btn btn-sm btn-outline" type='submit'>Post to  /vdb/S2</button>
         </form>
        </div>
    )
}